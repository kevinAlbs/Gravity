<html>
<head>
	<title>Builder</title>
	<link href="style.css" rel="stylesheet" type="text/css" />
	<style>
	/* Generated by Font Squirrel (http://www.fontsquirrel.com) on May 26, 2013 */
	#screen-builder{
		width: 1000px;
		height: 600px;
		position: relative;
		overflow: visible;
	}
	#scroller{
		width: 600px;
		height: 600px;
		background: transparent;
		position: absolute;
		top: 0px;
		left: 0px;
	}
	.object{
		position: absolute !important;
		left: 0px;
		top: 0px;
		background: rgba(100,100,100,.8);
	}
	.object.selected{
		outline: 1px green dotted;
		
	}
	.object:hover{
		background: rgba(100,100,100,1);
	}
	.platform, .kblock{
		width: 100px;
		height: 10px;
	}
	.end{
		width: 10px;
		height: 100px;
		background: "#F00";
		top: 300px;
		left: 300px;
	}
	.dot{
		width: 10px;
		height: 10px;
		background: #14A;
	}
	.object input[type=text]{
		position: absolute;
		bottom: -15px;
		border: 1px black solid;	
		width: 30px;
		z-index: 6;
		display: none;
	}
	.object .radius{
		height: 5px;
		background: rgba(100,100,100,.5);
		position: absolute;
		left: 0px;
		top: 10px;
	}
	.object:hover input[type=text], .object input[type=text]:focus{
		display: block;
	}
	.zombie{
		width: 15px;
		height: 87px;
		background: rgba(100,0,0,.8);
	}
	.player{
		width: 16px;
		height: 16px;
		top: 210px;
		left: 80px;
		background: rgba(100,100,200,.8);
	}
	.platform.init1{
		top: 0px;
		left: 0px;
		width: 600px;
		height: 1px;
	}
	.platform.init2{
		top: 0px;
		left: 0px;
		width: 1px;
		height: 600px;
	}
	.platform.init3{
		top: 599px;
		left: 0px;
		width: 600px;
		height: 1px;
	}
	.platform.init4{
		top: 0px;
		left: 599px;
		width: 1px;
		height: 600px;
	}
	.kblock{
		background: #0F0;
	}
	#output{
		width: 100%;
		margin-top: 2em;
		height: 10em;
	}
	.screen{
		display: none;
	}
	.lasergun input{

	}
	.lasergun{
		width: 5px;
		height: 5px;
		background: #555;
	}
	.lasergun .handle{
		position: absolute;
		left: 10px;
		top: 10px;
		width: 10px;
		height: 10px;
		border-radius: 5px;
		background: #000;
	}
	</style>
	<link href="jquery-ui/themes/base/jquery.ui.all.css" type="text/css" rel="stylesheet"/>
</head>
<body>
<div id="toolbar">
	<button value="cursor" data-cursor="auto">Cursor</button>
	<button value="platform" data-cursor="auto">H-Platform (h)</button>
	<button value="vplatform" data-cursor="auto">V-Platform (v)</button>
	<button value="kblock" data-cursor="auto">KBlock (k)</button>
	<button value="dot" data-cursor="auto">Dot (o)</button>
	<button value="lasergun" data-cursor="auto">Lasagne (l)</button>
	<button value="delete" data-cursor="url('images/delete.png'), auto">Delete (d)</button>
	<button value="export" data-cursor="auto">Export (e)</button>
	To switch, press (q)
	<span>Tool: cursor</span>
</div>
<div id="container">
	<div id="screen-builder" class="screen no-highlight">
		<div id="scroller" class="">
		<div class="object player"></div>
		<div class="object end"></div>
		<div class="object platform init1"></div>
		<div class="object platform init2"></div>
		<div class="object platform init3"></div>
		<div class="object platform init4"></div>
		</div>
	</div>
	<div id="screen-loading" class="screen no-highlight">
		Loading...
	</div>
	<div id="screen-gameplay" class="screen no-highlight">
		<canvas id="mycanvas" width="600" height="600"></canvas>
	</div>
</div>
<textarea id="output"></textarea>
<p id="debug"></p>

<script>
	var GM = {}; //mediator for gameplay, screens, dependency loading
	GM.debug = true;
	var fileInput = null; //used for loading
	//I don't quite like the sequential file loading, but it'll do for now
	//Also, the naming scheme is Capital first for class, lowercase for singleton (just object)
</script>
<!-- builder depends on jQuery and jQuery ui -->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>


<script src="jquery-ui/ui/jquery.ui.core.js"></script>
<script src="jquery-ui/ui/jquery.ui.widget.js"></script>
<script src="jquery-ui/ui/jquery.ui.mouse.js"></script>
<script src="jquery-ui/ui/jquery.ui.draggable.js"></script>
<script src="jquery-ui/ui/jquery.ui.droppable.js"></script>
<script src="jquery-ui/ui/jquery.ui.resizable.js"></script>

<script src="data.js"></script>
<script src="utils.js"></script>
<script src="GM.js"></script>
<script src="Screen.js"></script>
<script src="GameScreen.js"></script>
<script src="BuilderScreen.js"></script>
<script src="LoadingScreen.js"></script>
<script src="Paintable.js"></script>
<script src="Animation.js"></script>
<script src="AnimationSet.js"></script>
<script src="Movable.js"></script>
<script src="Mob.js"></script>
<script src="Person.js"></script>
<script src="Player.js"></script>
<script src="game.js"></script>
<script src="Platform.js"></script>
<script src="KBlock.js"></script>
<script src="Dot.js"></script>
<script src="LaserGun.js"></script>
<script src="platformList.js"></script>
<script src="objectList.js"></script>
<script src="particleList.js"></script>
<script src="viewport.js"></script>
<script>
fileInput = GM.data.stages[0];
var bScreen = new BuilderScreen(),
	gScreen = new GameScreen();
var flag = false;


function toggleScreen(){
	if(GM.curScreen == bScreen){
		GM.switchScreen(gScreen);
	}
	else if(GM.curScreen == gScreen){
		GM.switchScreen(bScreen);
	}
}
$(document).on("keypress", function(e){
	var c = String.fromCharCode(e.keyCode);
	if(c == 'q'){
		bScreen.exportJson();
		toggleScreen();
	}
});

function build(){
	GM.switchScreen(new LoadingScreen(bScreen));
}

function loadJson(input){
	GM.data.builder = {};
	GM.data.builder.output = input;
	bScreen.importJson(input);
	GM.switchScreen(new LoadingScreen(bScreen));
}

function pageLoaded(){
	//onces deps are loaded, start game
	if(fileInput != null){
		loadJson(fileInput);
	}
	else{
		GM.switchScreen(new LoadingScreen(bScreen));
	}
}
window.onbeforeunload = function() {
      //  return "Are you sure you want to leave?";
  }
window.addEventListener("load", pageLoaded);
</script>
</body>
</html>